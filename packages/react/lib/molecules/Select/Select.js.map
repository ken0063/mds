{"version":3,"file":"Select.js","sources":["../../../src/molecules/Select/Select.tsx"],"sourcesContent":["import {\n  createRef,\n  FC,\n  KeyboardEventHandler,\n  ReactNode,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\nimport Text from \"../../atoms/Text\";\n\nexport const KEY_CODES = {\n  ENTER: 13,\n  SPACE: 32,\n  DOWN_ARROW: 40,\n  ESC: 27,\n  UP_ARROW: 38,\n};\n\ninterface SelectOptionProps {\n  value: string;\n  label: string;\n}\ninterface RenderOptionProps {\n  isSelected: boolean;\n  options: SelectOptionProps;\n  getOptionRecommendedProps: (overrideProps?: Object) => Object;\n}\n\ninterface SelectProps {\n  optionHandler?: (option: SelectOptionProps, optionIndex: number) => void;\n  options?: SelectOptionProps[];\n  label?: string;\n  renderOption?: (props: RenderOptionProps) => ReactNode;\n}\n\nconst getPreviousOptionIndex = (\n  currentIndex: number | null,\n  options: Array<SelectOptionProps>\n) => {\n  if (currentIndex === null) {\n    return 0;\n  }\n\n  if (currentIndex === 0) {\n    return options.length - 1;\n  }\n\n  return currentIndex - 1;\n};\n\nconst getNextOptionIndex = (\n  currentIndex: number | null,\n  options: Array<SelectOptionProps>\n) => {\n  if (currentIndex === null) {\n    return 0;\n  }\n\n  if (currentIndex === options.length - 1) {\n    return 0;\n  }\n\n  return currentIndex + 1;\n};\n\nconst Select: FC<SelectProps> = ({\n  options = [],\n  label = \"Please select an option\",\n  optionHandler,\n  renderOption,\n}) => {\n  const [isOpen, setIsOpen] = useState<boolean>(false);\n  const [selectedIndex, setSelectedIndex] = useState<null | number>(null);\n  const [highlightedIndex, setHighlightedIndex] = useState<null | number>(null);\n  const labelRef = useRef<HTMLButtonElement>(null);\n  const [optionRefs, setOptionRefs] = useState<\n    React.RefObject<HTMLLIElement | null>[]\n  >([]);\n  const [overlayTop, setOverlayTop] = useState<number>(0);\n\n  const handleSelectToggle = () => {\n    setIsOpen(!isOpen);\n  };\n\n  const onOptionSelected = (option: SelectOptionProps, optionIndex: number) => {\n    if (optionHandler) {\n      optionHandler(option, optionIndex);\n    }\n    setSelectedIndex(optionIndex);\n    setIsOpen(false);\n  };\n\n  useEffect(() => {\n    setOverlayTop(labelRef.current?.offsetHeight || 0);\n  }, []);\n\n  let selectedOption = null;\n  if (selectedIndex !== null) {\n    selectedOption = options[selectedIndex];\n  }\n\n  const highlightOption = (optionIndex: number | null) => {\n    setHighlightedIndex(optionIndex);\n  };\n\n  const onButtonKeyDown: KeyboardEventHandler = (event) => {\n    event.preventDefault();\n\n    if (\n      [KEY_CODES.ENTER, KEY_CODES.SPACE, KEY_CODES.DOWN_ARROW].includes(\n        event.keyCode\n      )\n    ) {\n      setIsOpen(true);\n\n      // set focus on the list item\n      highlightOption(0);\n    }\n  };\n\n  useEffect(() => {\n    setOptionRefs(options.map((_) => createRef<HTMLLIElement>()));\n  }, [options.length]);\n\n  useEffect(() => {\n    if (highlightedIndex !== null && isOpen) {\n      const ref = optionRefs[highlightedIndex];\n\n      if (ref && ref.current) {\n        ref.current.focus();\n      }\n    }\n  }, [isOpen, highlightedIndex]);\n\n  const onOptionKeyDown: KeyboardEventHandler = (e) => {\n    if (e.keyCode === KEY_CODES.ESC) {\n      setIsOpen(false);\n\n      return;\n    }\n\n    if (e.keyCode === KEY_CODES.DOWN_ARROW) {\n      highlightOption(getNextOptionIndex(highlightedIndex, options));\n    }\n\n    if (e.keyCode === KEY_CODES.UP_ARROW) {\n      highlightOption(getPreviousOptionIndex(highlightedIndex, options));\n    }\n\n    if (e.keyCode === KEY_CODES.ENTER) {\n      onOptionSelected(options[highlightedIndex!], highlightedIndex!);\n    }\n  };\n\n  return (\n    <div className='mds-select'>\n      <button\n        ref={labelRef}\n        data-testid='mds-select-button'\n        className='mds-select__label'\n        onClick={handleSelectToggle}\n        aria-controls='mds-select-list'\n        aria-haspopup={true}\n        aria-expanded={isOpen ? true : undefined}\n        onKeyDown={onButtonKeyDown}\n      >\n        <Text>{selectedOption === null ? label : selectedOption?.label}</Text>\n\n        <svg\n          xmlns='http://www.w3.org/2000/svg'\n          fill='none'\n          viewBox='0 0 24 24'\n          strokeWidth='1.5'\n          stroke='currentColor'\n          width='1rem'\n          height='1rem'\n          className={`mds-select__caret ${\n            isOpen ? \"mds-select__caret--open\" : \"mds-select__caret--close\"\n          }`}\n        >\n          <path\n            strokeLinecap='round'\n            strokeLinejoin='round'\n            d='M19.5 8.25l-7.5 7.5-7.5-7.5'\n          />\n        </svg>\n      </button>\n\n      <ul\n        role='menu'\n        aria-hidden={isOpen ? undefined : false}\n        id='mds-select-list'\n        className={`mds-select__overlay ${\n          isOpen ? \"mds-select__overlay--open\" : \"\"\n        }`}\n        style={{ top: overlayTop }}\n      >\n        {options?.map((item, idx) => {\n          const isSelected = selectedIndex === idx;\n          const isHighlighted = highlightedIndex === idx;\n          const ref = optionRefs[idx];\n          const renderOptionProps = {\n            ref,\n            options: item,\n            isSelected,\n            getOptionRecommendedProps: (overrideProps = {}) => {\n              return {\n                ref,\n                role: \"menuitemradio\",\n                \"aria-label\": item?.label,\n                \"aria-checked\": isSelected ? true : undefined,\n                onKeyDown: onOptionKeyDown,\n                tabIndex: isHighlighted ? -1 : 0,\n                onMouseEnter: () => highlightOption(idx),\n                onMouseLeave: () => highlightOption(null),\n                className: `mds-select__option\n                        ${isSelected ? \"mds-select__option--selected\" : \"\"}\n                        ${\n                          isHighlighted ? \"mds-select__option--highlighted\" : \"\"\n                        }\n                    `,\n                key: item?.value,\n                onClick: () => onOptionSelected(item, idx),\n                ...overrideProps,\n              };\n            },\n          };\n          if (renderOption) {\n            return renderOption(renderOptionProps);\n          }\n          return (\n            <li {...renderOptionProps.getOptionRecommendedProps()}>\n              <Text>{item?.label}</Text>\n              {isSelected && (\n                <svg\n                  xmlns='http://www.w3.org/2000/svg'\n                  fill='none'\n                  viewBox='0 0 24 24'\n                  strokeWidth='1.5'\n                  stroke='currentColor'\n                  width='1rem'\n                  height='1rem'\n                >\n                  <path\n                    strokeLinecap='round'\n                    strokeLinejoin='round'\n                    d='M4.5 12.75l6 6 9-13.5'\n                  />\n                </svg>\n              )}\n            </li>\n          );\n        })}\n      </ul>\n    </div>\n  );\n};\n\nexport default Select;\n"],"names":["_jsxs","_jsx"],"mappings":"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"}